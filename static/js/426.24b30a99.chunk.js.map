{"version":3,"file":"static/js/426.24b30a99.chunk.js","mappings":"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","sources":["pages/blog-pages/EditBlogPage.js"],"sourcesContent":["import { useContext, useState, useEffect } from \"react\";\nimport { Box, Tabs, Tab, TextField, Button, Snackbar, Alert } from \"@mui/material\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport CustomAppBar from \"../../components/shared-components/AppBar/AppBar\";\nimport DraftJsWysiwyg from \"../../components/blog-components/Draft-js-wysiwyg/Draft-js-wysiwyg\";\nimport BlogService from \"../../services/BlogService\";\nimport { SettingsContext } from \"../../context/SettingsContext\";\nimport { useUser } from \"../../context/UserContext\";\nimport { EditorState, convertToRaw, convertFromRaw } from \"draft-js\";\n\nconst EditBlogPage = () => {\n  const navigate = useNavigate();\n  const { blogID } = useParams();\n  const { themeMode, language } = useContext(SettingsContext);\n  const { userState } = useUser();\n\n  const [activeTab, setActiveTab] = useState(0);\n  const [tabsData, setTabsData] = useState({\n    CN: { title: \"\", content: EditorState.createEmpty() },\n    EN: { title: \"\", content: EditorState.createEmpty() },\n  });\n\n  const [snackbarOpen, setSnackbarOpen] = useState(false);\n  const [snackbarMessage, setSnackbarMessage] = useState(\"\");\n  const [snackbarSeverity, setSnackbarSeverity] = useState(\"success\");\n\n  const handleSnackbarClose = () => {\n    setSnackbarOpen(false);\n  };\n\n  // 获取博客详情数据\n  useEffect(() => {\n    const fetchBlogData = async () => {\n      try {\n        const blogData = await BlogService.getBlog(blogID, userState.access);\n        setTabsData({\n          CN: {\n            title: blogData.cn_title || \"\",\n            content: EditorState.createWithContent(convertFromRaw(JSON.parse(blogData.cn_content))),\n          },\n          EN: {\n            title: blogData.en_title || \"\",\n            content: EditorState.createWithContent(convertFromRaw(JSON.parse(blogData.en_content))),\n          },\n        });\n      } catch (error) {\n        console.error(\"Error fetching blog data:\", error);\n      }\n    };\n\n    fetchBlogData();\n  }, [blogID, userState.access]);\n\n  const handleTabChange = (event, newValue) => {\n    setActiveTab(newValue);\n  };\n\n  const handleInputChange = (langKey, field, value) => {\n    setTabsData((prev) => ({\n      ...prev,\n      [langKey]: { ...prev[langKey], [field]: value },\n    }));\n  };\n\n  const handleContentChange = (langKey, editorState) => {\n    setTabsData((prev) => ({\n      ...prev,\n      [langKey]: { ...prev[langKey], content: editorState },\n    }));\n  };\n\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n\n    const dataToSubmit = {\n      cn_title: tabsData.CN.title,\n      en_title: tabsData.EN.title,\n      author: userState.username,\n      cn_content: JSON.stringify(convertToRaw(tabsData.CN.content.getCurrentContent())),\n      en_content: JSON.stringify(convertToRaw(tabsData.EN.content.getCurrentContent())),\n    };\n\n    try {\n      await BlogService.editBlog(blogID, dataToSubmit, userState.access);\n      setSnackbarMessage(language === \"cn\" ? \"博客已更新\" : \"Blog updated\");\n      setSnackbarSeverity(\"success\");\n      setSnackbarOpen(true);\n      navigate(`/blog/${blogID}`);\n    } catch (error) {\n      console.error(\"Error editing blog:\", error);\n      setSnackbarMessage(language === \"cn\" ? \"更新失败\" : \"Failed to update blog\");\n      setSnackbarSeverity(\"error\");\n      setSnackbarOpen(true);\n    }\n  };\n\n  const labels = {\n    title: language === \"cn\" ? \"标题\" : \"Title\",\n    content: language === \"cn\" ? \"内容\" : \"Content\",\n    submit: language === \"cn\" ? \"提交\" : \"Submit\",\n  };\n\n  return (\n    <Box sx={{ display: \"flex\", flexDirection: \"column\", height: \"100vh\", overflow: \"hidden\" }}>\n      <CustomAppBar />\n      <Box\n        sx={{\n          flex: 1,\n          display: \"flex\",\n          flexDirection: \"column\",\n          maxWidth: 1000,\n          width: \"100%\",\n          mx: \"auto\",\n          mt: 11,\n          px: 2,\n          overflow: \"hidden\",\n        }}\n      >\n        <Tabs\n          value={activeTab}\n          onChange={handleTabChange}\n          sx={{ flexShrink: 0 }}\n          variant=\"fullWidth\"\n        >\n          <Tab label=\"CN\" />\n          <Tab label=\"EN\" />\n        </Tabs>\n\n        <Box\n          component=\"form\"\n          onSubmit={handleSubmit}\n          sx={{\n            display: \"flex\",\n            flexDirection: \"column\",\n            flex: 1,\n            overflow: \"hidden\",\n          }}\n        >\n          <TextField\n            label={\n              activeTab === 0 ? `${labels.title} (CN)` : `${labels.title} (EN)`\n            }\n            variant=\"filled\"\n            value={activeTab === 0 ? tabsData.CN.title : tabsData.EN.title}\n            onChange={(e) =>\n              handleInputChange(activeTab === 0 ? \"CN\" : \"EN\", \"title\", e.target.value)\n            }\n            fullWidth\n            sx={{\n              flexShrink: 0,\n              '& .MuiFilledInput-root': {\n                backgroundColor: 'transparent',\n                '&:hover': { backgroundColor: 'transparent' },\n                '&.Mui-focused': { backgroundColor: 'transparent' },\n              },\n            }}\n          />\n\n          <Box\n            sx={{\n              flex: 1,\n              display: \"flex\",\n              flexDirection: \"column\",\n              minHeight: 0,\n            }}\n          >\n            <DraftJsWysiwyg\n              editorState={activeTab === 0 ? tabsData.CN.content : tabsData.EN.content}\n              onEditorStateChange={(editorState) =>\n                handleContentChange(activeTab === 0 ? \"CN\" : \"EN\", editorState)\n              }\n            />\n          </Box>\n\n          <Box\n            sx={{\n              display: \"flex\",\n              justifyContent: \"flex-end\",\n              gap: 2,\n              mt: 2,\n              mb: 2,\n              flexShrink: 0,\n            }}\n          >\n            <Button type=\"submit\" variant=\"contained\" color=\"primary\">\n              {labels.submit}\n            </Button>\n          </Box>\n        </Box>\n      </Box>\n\n      <Snackbar\n        open={snackbarOpen}\n        autoHideDuration={3000}\n        onClose={handleSnackbarClose}\n        anchorOrigin={{ vertical: \"top\", horizontal: \"center\" }}\n      >\n        <Alert severity={snackbarSeverity} sx={{ width: \"100%\" }}>\n          {snackbarMessage}\n        </Alert>\n      </Snackbar>\n    </Box>\n  );\n};\n\nexport default EditBlogPage;\n"],"names":["EditBlogPage","navigate","useNavigate","blogID","useParams","themeMode","language","useContext","SettingsContext","userState","useUser","activeTab","setActiveTab","useState","tabsData","setTabsData","CN","title","content","EditorState","createEmpty","EN","snackbarOpen","setSnackbarOpen","snackbarMessage","setSnackbarMessage","snackbarSeverity","setSnackbarSeverity","useEffect","async","blogData","BlogService","getBlog","access","cn_title","createWithContent","convertFromRaw","JSON","parse","cn_content","en_title","en_content","error","console","fetchBlogData","labels","submit","_jsxs","Box","sx","display","flexDirection","height","overflow","children","_jsx","CustomAppBar","flex","maxWidth","width","mx","mt","px","Tabs","value","onChange","handleTabChange","event","newValue","flexShrink","variant","Tab","label","component","onSubmit","e","preventDefault","dataToSubmit","author","username","stringify","convertToRaw","getCurrentContent","editBlog","TextField","handleInputChange","langKey","field","target","prev","fullWidth","backgroundColor","minHeight","DraftJsWysiwyg","editorState","onEditorStateChange","handleContentChange","justifyContent","gap","mb","Button","type","color","Snackbar","open","autoHideDuration","onClose","handleSnackbarClose","anchorOrigin","vertical","horizontal","Alert","severity"],"sourceRoot":""}