"use strict";(self.webpackChunkreact=self.webpackChunkreact||[]).push([[426],{5426:(t,e,n)=>{n.r(e),n.d(e,{default:()=>E});var o=n(5043),r=n(7353),i=n(3625),l=n(4056),a=n(5795),c=n(1906),s=n(1637),d=n(794),u=n(4194),x=n(9002),h=n(4494),f=n(2141),p=n(330),C=n(6295),g=n(2678),m=n(4410),N=n(579);const E=()=>{const t=(0,x.Zp)(),{blogID:e}=(0,x.g)(),{themeMode:n,language:E}=(0,o.useContext)(C.l),{userState:S}=(0,g.J)(),[b,v]=(0,o.useState)(0),[y,A]=(0,o.useState)({CN:{title:"",content:m.EditorState.createEmpty()},EN:{title:"",content:m.EditorState.createEmpty()}}),[j,w]=(0,o.useState)({CN:{title:"",content:m.EditorState.createEmpty()},EN:{title:"",content:m.EditorState.createEmpty()}}),[k,_]=(0,o.useState)(!1),[D,W]=(0,o.useState)(""),[R,J]=(0,o.useState)("success"),[O,F]=(0,o.useState)(!1);(0,o.useEffect)((()=>{(async()=>{try{const t=await p.A.getBlog(e,S.access),n={CN:{title:t.cn_title||"",content:m.EditorState.createWithContent((0,m.convertFromRaw)(JSON.parse(t.cn_content)))},EN:{title:t.en_title||"",content:m.EditorState.createWithContent((0,m.convertFromRaw)(JSON.parse(t.en_content)))}};A(n),w(n)}catch(t){console.error("Error fetching blog data:",t)}})()}),[e,S.access]);const M={title:"cn"===E?"\u6807\u9898":"Title",content:"cn"===E?"\u5185\u5bb9":"Content",submit:"cn"===E?"\u63d0\u4ea4":"Submit",restore:"cn"===E?"\u6062\u590d":"Restore"};return(0,N.jsxs)(r.A,{sx:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden"},children:[(0,N.jsx)(h.A,{}),(0,N.jsxs)(r.A,{sx:{flex:1,display:"flex",flexDirection:"column",maxWidth:1e3,width:"100%",mx:"auto",mt:11,px:2,overflow:"hidden"},children:[(0,N.jsxs)(i.A,{value:b,onChange:(t,e)=>{v(e)},sx:{flexShrink:0},variant:"fullWidth",children:[(0,N.jsx)(l.A,{label:"CN"}),(0,N.jsx)(l.A,{label:"EN"})]}),(0,N.jsxs)(r.A,{component:"form",onSubmit:async n=>{n.preventDefault(),F(!0);const o={cn_title:y.CN.title,en_title:y.EN.title,author:S.username,cn_content:JSON.stringify((0,m.convertToRaw)(y.CN.content.getCurrentContent())),en_content:JSON.stringify((0,m.convertToRaw)(y.EN.content.getCurrentContent()))};try{await p.A.editBlog(e,o,S.access),t(`/blog/${e}?updated=true`)}catch(r){console.error("Error editing blog:",r),W("cn"===E?"\u66f4\u65b0\u5931\u8d25":"Failed to update blog"),J("error"),_(!0)}finally{F(!1)}},sx:{display:"flex",flexDirection:"column",flex:1,overflow:"hidden"},children:[(0,N.jsx)(a.A,{label:0===b?`${M.title} (CN)`:`${M.title} (EN)`,variant:"filled",value:0===b?y.CN.title:y.EN.title,onChange:t=>{return e=0===b?"CN":"EN",n="title",o=t.target.value,void A((t=>({...t,[e]:{...t[e],[n]:o}})));var e,n,o},fullWidth:!0,sx:{flexShrink:0,"& .MuiFilledInput-root":{backgroundColor:"transparent","&:hover":{backgroundColor:"transparent"},"&.Mui-focused":{backgroundColor:"transparent"}}}}),(0,N.jsx)(r.A,{sx:{flex:1,display:"flex",flexDirection:"column",minHeight:0},children:(0,N.jsx)(f.A,{editorState:0===b?y.CN.content:y.EN.content,onEditorStateChange:t=>((t,e)=>{A((n=>({...n,[t]:{...n[t],content:e}})))})(0===b?"CN":"EN",t)})}),(0,N.jsxs)(r.A,{sx:{display:"flex",justifyContent:"flex-end",gap:2,mt:2,mb:2,flexShrink:0},children:[(0,N.jsx)(c.A,{type:"button",variant:"outlined",color:"secondary",onClick:()=>{A(j),W("cn"===E?"\u5df2\u6062\u590d\u5230\u539f\u59cb\u5185\u5bb9":"Restored to original content"),J("info"),_(!0)},disabled:O,sx:{minWidth:90},children:M.restore}),(0,N.jsx)(c.A,{type:"submit",variant:"contained",color:"primary",disabled:O,sx:{minWidth:90},children:O?(0,N.jsx)(s.A,{size:20}):M.submit})]})]})]}),(0,N.jsx)(d.A,{open:k,autoHideDuration:3e3,onClose:()=>{_(!1)},anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,N.jsx)(u.A,{severity:R,sx:{width:"100%"},children:D})})]})}}}]);
//# sourceMappingURL=426.51192b8d.chunk.js.map